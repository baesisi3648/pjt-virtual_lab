graph TD
    START((START)) --> planning

    planning["ğŸ“ Planning<br/><i>PIê°€ ì „ë¬¸ê°€ íŒ€ êµ¬ì„±</i>"]
    researching["ğŸ‘¨â€ğŸ”¬ Researching<br/><i>ì „ë¬¸ê°€ ê°œë³„ ë¶„ì„ (RAG+ì›¹ê²€ìƒ‰)</i>"]
    critique["ğŸ•µï¸ Critique<br/><i>Criticì´ ì „ë¬¸ê°€ë³„ í‰ê°€</i>"]
    pi_summary["ğŸ“ PI Summary<br/><i>ë¼ìš´ë“œë³„ ìŸì  ìš”ì•½ + ì„ì‹œ ê²°ë¡ </i>"]
    check_round{"Round < 3?"}
    increment_round["â« Increment Round<br/><i>ë¼ìš´ë“œ ì¦ê°€ + ê¸°ë¡ ì•„ì¹´ì´ë¸Œ</i>"]
    round_revision["ğŸ‘¨â€ğŸ”¬ Round Revision<br/><i>ì „ë¬¸ê°€ í”¼ë“œë°± ë°˜ì˜ ìˆ˜ì •Â·ë³´ì™„</i>"]
    final_synthesis["ğŸ“ Final Synthesis<br/><i>3ë¼ìš´ë“œ ë² ìŠ¤íŠ¸ íŒŒíŠ¸ ì„ ë³„<br/>ìµœì¢… ë³´ê³ ì„œ ì‘ì„±</i>"]
    END((END))

    planning --> researching
    researching --> critique
    critique --> pi_summary
    pi_summary --> check_round
    check_round -- "Yes (ê³„ì†)" --> increment_round
    check_round -- "No (3ë¼ìš´ë“œ ì™„ë£Œ)" --> final_synthesis
    increment_round --> round_revision
    round_revision --> critique
    final_synthesis --> END

    %% Styling
    classDef piNode fill:#4F46E5,stroke:#3730A3,color:#fff,stroke-width:2px
    classDef specialistNode fill:#059669,stroke:#047857,color:#fff,stroke-width:2px
    classDef criticNode fill:#DC2626,stroke:#B91C1C,color:#fff,stroke-width:2px
    classDef controlNode fill:#D97706,stroke:#B45309,color:#fff,stroke-width:2px
    classDef terminalNode fill:#6B7280,stroke:#4B5563,color:#fff,stroke-width:2px

    class planning,pi_summary,final_synthesis piNode
    class researching,round_revision specialistNode
    class critique criticNode
    class check_round,increment_round controlNode
    class START,END terminalNode
